<html><head><base href="https://example.com" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Home</title>

<style>
:root {
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --primary-color: #8A2BE2;
  --secondary-color: #4B0082;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: #000;
  color: #fff;
  overflow: hidden;
}

#notification-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 1000;
}

.header-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.user-info {
  display: flex;
  align-items: center;
  gap: 10px;
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
}

.user-name {
  font-size: 16px;
  color: white;
}

.resources-mini {
  display: flex;
  gap: 15px;
}

.resource-mini-item {
  display: flex;
  align-items: center;
  gap: 5px;
  background: rgba(255, 255, 255, 0.1);
  padding: 5px 10px;
  border-radius: 15px;
}

.resource-mini-icon {
  font-size: 16px;
}

.resource-mini-amount {
  font-size: 14px;
  color: white;
}

.mobile-container {
  position: relative;
  max-width: 430px;
  height: 100vh;
  height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  margin: 0 auto;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  overflow-y: auto;
  overflow-x: hidden;
  padding: calc(10px + var(--safe-area-inset-top)) 15px calc(65px + var(--safe-area-inset-bottom));
  box-sizing: border-box;
}

.quick-access-grid {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 10px;
  padding: 10px 0;
}

.quick-access-icon {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  padding: 8px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.3s ease;
}

.quick-access-icon:hover {
  transform: scale(1.1);
  background: rgba(255, 255, 255, 0.15);
}

.quick-access-icon span {
  font-size: 20px;
}

.quick-access-icon small {
  font-size: 10px;
  color: rgba(255, 255, 255, 0.8);
}

.panda-display {
  position: relative;
  padding: 20px;
  margin: 20px 0;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 20px;
  text-align: center;
}

.panda-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
}

.panda-avatar {
  position: relative;
  width: 120px;
  height: 120px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: float 3s ease-in-out infinite;
}

.panda-emoji {
  font-size: 60px;
}

.mood-indicator {
  position: absolute;
  top: -10px;
  right: -10px;
  background: var(--primary-color);
  border-radius: 50%;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid white;
  animation: bounce 2s infinite;
}

.status-summary {
  text-align: center;
  margin: 10px 0;
}

.status-text {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
  margin-top: 5px;
}

.interaction-buttons {
  display: flex;
  gap: 8px;
  margin-top: 10px;
  flex-wrap: wrap;
  justify-content: center;
}

.interact-btn {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 8px 16px;
  background: var(--primary-color);
  border: none;
  border-radius: 20px;
  color: white;
  font-size: 14px;
  transition: all 0.3s ease;
  flex: 0 1 auto;
  cursor: pointer;
}

.interact-btn:hover {
  background: var(--secondary-color);
  transform: scale(1.05);
}

.task-section {
  padding: 12px;
  margin: 15px 0;
}

.pet-progress-section {
  padding: 15px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 15px;
  margin-top: 15px;
}

.progress-bar-container {
  position: relative;
  height: 20px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  margin: 10px 0;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background: var(--primary-color);
  transition: width 0.3s ease;
}

.progress-labels {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.8);
  margin-top: 5px;
}

.pet-stats {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin: 10px 0;
}

.pet-stat-item {
  background: rgba(255, 255, 255, 0.1);
  padding: 8px 12px;
  border-radius: 10px;
}

.backpack-section {
  padding: 15px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 15px;
  margin: 15px 0;
}

.backpack-section h3 {
  margin-bottom: 15px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.backpack-filters span {
  margin-left: 10px;
  cursor: pointer;
  color: rgba(255, 255, 255, 0.8);
  transition: color 0.3s ease;
}

.backpack-filters span.active {
  color: var(--primary-color);
}

.backpack-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-top: 10px;
}

.backpack-item {
  position: relative;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  padding: 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  min-height: 80px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.backpack-item:active {
  transform: scale(0.95);
}

.backpack-item.empty {
  background: rgba(255, 255, 255, 0.05);
  border: 2px dashed rgba(255, 255, 255, 0.1);
}

.backpack-item-icon {
  font-size: 24px;
}

.backpack-item-count {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.8);
}

.backpack-item-new {
  position: absolute;
  top: -5px;
  right: -5px;
  background: var(--primary-color);
  color: white;
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 10px;
  animation: pulse 2s infinite;
}

.reward-notification {
  position: fixed;
  bottom: 80px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(138, 43, 226, 0.9);
  padding: 15px 25px;
  border-radius: 20px;
  color: white;
  text-align: center;
  z-index: 1000;
  animation: slideUp 0.3s ease-out;
}

.milestone-notice {
  background: rgba(138, 43, 226, 0.1);
  border-radius: 15px;
  padding: 15px;
  margin: 15px 0;
}

.notice-card {
  display: flex;
  gap: 15px;
  align-items: flex-start;
}

.notice-icon {
  font-size: 24px;
  padding: 10px;
  background: rgba(138, 43, 226, 0.2);
  border-radius: 50%;
}

.notice-content {
  flex: 1;
}

.notice-content h4 {
  margin-bottom: 8px;
  color: var(--primary-color);
}

.notice-content p {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: 8px;
}

.notice-content ul {
  list-style: none;
  padding-left: 0;
}

.notice-content li {
  font-size: 13px;
  color: rgba(255, 255, 255, 0.7);
  margin: 4px 0;
}

.group-leaderboard {
  margin-bottom: 20px;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

@keyframes slideUp {
  from { transform: translate(-50%, 100%); opacity: 0; }
  to { transform: translate(-50%, 0); opacity: 1; }
}

@keyframes float {
  0% { transform: translatey(0px); }
  50% { transform: translatey(-10px); }
  100% { transform: translatey(0px); }
}

@keyframes bounce {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

.item-details-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  padding: 20px;
  border-radius: 20px;
  width: 90%;
  max-width: 300px;
  z-index: 1001;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translate(-50%, -60%); }
  to { opacity: 1; transform: translate(-50%, -50%); }
}

.modal-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  z-index: 1000;
}

.item-details-content {
  text-align: center;
}

.item-details-icon {
  font-size: 40px;
  margin: 10px 0;
}

.item-details-info {
  margin: 15px 0;
}

.item-details-actions {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-top: 20px;
}

.item-details-btn {
  padding: 8px 16px;
  border-radius: 15px;
  border: none;
  background: var(--primary-color);
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
}

.item-details-btn:hover {
  background: var(--secondary-color);
}

.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  max-width: 430px;
  background: rgba(26, 26, 46, 0.95);
  backdrop-filter: blur(10px);
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: calc(10px + var(--safe-area-inset-bottom)) 0 var(--safe-area-inset-bottom);
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  z-index: 1000;
}

.nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-decoration: none;
  color: rgba(255, 255, 255, 0.6);
  font-size: 12px;
  padding: 8px 12px;
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
  min-width: 60px;
  background: none;
  border: none;
}

.nav-item.active {
  color: var(--primary-color);
}

.nav-item .nav-icon {
  font-size: 20px;
  margin-bottom: 4px;
  position: relative;
  transition: transform 0.3s ease;
}

.nav-item.active .nav-icon {
  transform: scale(1.1);
}

.nav-item:active {
  transform: scale(0.95);
}

.nav-item:hover {
  color: var(--primary-color);
  opacity: 0.8;
}

.nav-item.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 20px;
  height: 3px;
  background: var(--primary-color);
  border-radius: 2px;
}

.floating-task-btn {
  position: fixed;
  left: 50%;
  bottom: calc(var(--safe-area-inset-bottom) + 80px);
  transform: translateX(calc(-50% + (-190px + 20px))); /* Center then offset left */
  background: var(--primary-color);
  color: white;
  padding: 12px 24px;
  border-radius: 25px;
  border: none;
  display: flex;
  align-items: center;
  gap: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
  z-index: 999;
  cursor: pointer;
  max-width: 430px;
}

.floating-task-btn:hover {
  background: var(--secondary-color);
  transform: translateX(calc(-50% + (-190px + 20px))) scale(1.05);
}

.pet-advance-page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  z-index: 1001;
  overflow: hidden;
  display: none;
  animation: slideIn 0.5s ease-out forwards;
  padding: calc(10px + var(--safe-area-inset-top)) 15px calc(20px + var(--safe-area-inset-bottom));
}

@keyframes slideIn {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}

.advance-header {
  display: flex;
  align-items: center;
  padding: 20px;
  position: relative;
}

.back-btn {
  background: none;
  border: none;
  color: white;
  font-size: 24px;
  padding: 10px;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.back-btn:hover {
  transform: rotate(-10deg);
}

.advance-header h2 {
  flex: 1;
  text-align: center;
  margin: 0;
  font-size: 20px;
  color: var(--primary-color);
}

.advance-content {
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  height: calc(100vh - 80px); /* Adjusted to fit without scrolling */
  box-sizing: border-box;
}

.pet-portrait {
  text-align: center;
  margin-bottom: 15px;
}

.panda-avatar.large {
  width: 80px; /* Reduced size */
  height: 80px; /* Reduced size */
  margin: 0 auto;
  animation: shake 4s infinite;
}

@keyframes shake {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(5deg); }
  50% { transform: rotate(0deg); }
  75% { transform: rotate(-5deg); }
  100% { transform: rotate(0deg); }
}

.panda-avatar.large .panda-emoji {
  font-size: 40px; /* Reduced font size */
}

.level-info {
  margin-top: 15px;
  text-align: center;
}

.exp-progress {
  margin-top: 10px;
}

.exp-bar {
  width: 100%;
  height: 10px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 5px;
  overflow: hidden;
}

.exp-fill {
  height: 100%;
  background: var(--primary-color);
  transition: width 0.3s ease;
}

.elements-container {
  position: relative;
  width: 100%;
  max-width: 300px;
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  justify-content: center;
  align-items: center;
}

.element-slot {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  cursor: pointer;
}

.element-slot:hover {
  transform: scale(1.1);
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
}

.element-slot.water { background: rgba(0, 150, 255, 0.2); }
.element-slot.wood { background: rgba(76, 175, 80, 0.2); }
.element-slot.earth { background: rgba(121, 85, 72, 0.2); }
.element-slot.fire { background: rgba(255, 87, 34, 0.2); }
.element-slot.metal { background: rgba(255, 215, 0, 0.2); }

.element-icon {
  font-size: 24px;
  margin-bottom: 5px;
  transition: transform 0.3s ease;
}

.element-slot:hover .element-icon {
  transform: rotate(360deg);
}

.element-info {
  text-align: center;
  font-size: 12px;
}

.advance-btn {
  background: #4CAF50;
  color: white;
  border: none;
  padding: 10px 30px; /* Reduced padding */
  border-radius: 20px; /* Reduced border-radius */
  font-size: 16px; /* Reduced font size */
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.advance-btn:hover {
  transform: scale(1.05);
  background: #45a049;
}

.skill-hint {
  text-align: center;
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
  margin-top: 10px; /* Reduced margin */
}

.team-header {
  display: flex;
  align-items: center;
  padding: 20px;
  position: relative;
}

.team-content {
  padding: 20px;
  height: calc(100vh - 80px);
  overflow-y: auto;
}

.team-info {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
}

.team-rank {
  font-size: 18px;
  margin-bottom: 10px;
}

.team-progress {
  margin-top: 15px;
}

.progress-text {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
  margin-top: 5px;
}

.member-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 15px;
  margin-top: 15px;
}

.member-card {
  display: flex;
  align-items: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  padding: 15px;
  gap: 15px;
}

.member-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
}

.member-info {
  flex: 1;
}

.member-name {
  font-size: 16px;
  margin-bottom: 5px;
}

.member-progress {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
}

.member-rank {
  font-size: 18px;
  color: var(--primary-color);
}

.team-milestones {
  margin-top: 20px;
}

.milestone-list {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-top: 15px;
}

.milestone-item {
  display: flex;
  align-items: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  padding: 15px;
  gap: 15px;
}

.milestone-item.achieved {
  background: rgba(138, 43, 226, 0.2);
}

.milestone-icon {
  font-size: 24px;
}

.milestone-info {
  flex: 1;
}

.milestone-title {
  font-size: 16px;
  margin-bottom: 5px;
}

.milestone-desc {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
}

.milestone-reward {
  font-size: 14px;
  color: var(--primary-color);
}

.team-actions {
  display: flex;
  gap: 10px;
  margin-top: 20px;
  padding-bottom: 20px;
}

.team-actions .interact-btn {
  flex: 1;
}

.team-page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  z-index: 1001;
  overflow: hidden;
  animation: slideIn 0.5s ease-out forwards;
  padding: calc(10px + var(--safe-area-inset-top)) 15px calc(20px + var(--safe-area-inset-bottom));
}

.group-page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  z-index: 1001;
  overflow-y: auto;
  animation: slideIn 0.5s ease-out forwards;
  padding: calc(10px + var(--safe-area-inset-top)) 15px calc(20px + var(--safe-area-inset-bottom));
}

.group-header {
  display: flex;
  align-items: center;
  padding: 20px;
  position: relative;
}

.search-section {
  margin: 15px 0;
}

.search-bar {
  display: flex;
  gap: 10px;
  background: rgba(255, 255, 255, 0.1);
  padding: 10px;
  border-radius: 20px;
  margin-bottom: 15px;
}

.search-bar input {
  flex: 1;
  background: none;
  border: none;
  color: white;
  outline: none;
}

.search-bar .search-btn {
  background: none;
  border: none;
  color: white;
  cursor: pointer;
}

.filter-tags {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding: 5px 0;
}

.filter-tag {
  background: rgba(255, 255, 255, 0.1);
  padding: 5px 15px;
  border-radius: 15px;
  cursor: pointer;
  white-space: nowrap;
}

.filter-tag.active {
  background: var(--primary-color);
}

.group-cards {
  display: flex;
  flex-direction: column;
  gap: 15px;
  padding: 15px 0;
}

.group-card {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 15px;
}

.group-card-header {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 10px;
}

.group-avatar {
  width: 50px;
  height: 50px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 25px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
}

.group-info {
  flex: 1;
}

.group-type {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
  background: rgba(255, 255, 255, 0.1);
  padding: 2px 8px;
  border-radius: 10px;
}

.group-tags {
  display: flex;
  gap: 4px;
}

.tag {
  font-size: 10px;
  color: var(--primary-color);
  background: rgba(138, 43, 226, 0.1);
  padding: 2px 6px;
  border-radius: 8px;
}

.group-description {
  margin: 10px 0;
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
}

.group-actions {
  display: flex;
  gap: 10px;
  margin-top: 15px;
}

.join-btn, .details-btn {
  padding: 8px 16px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s ease;
}

.join-btn {
  background: var(--primary-color);
  color: white;
}

.join-btn:hover {
  background: var(--secondary-color);
}

.details-btn {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}

.details-btn:hover {
  background: rgba(255, 255, 255, 0.2);
}

.join-btn.joined {
  background: var(--secondary-color);
  opacity: 0.8;
}

.leaderboard-filters {
  display: flex;
  gap: 10px;
}

.filter-option {
  padding: 4px 12px;
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.1);
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s ease;
}

.filter-option.active {
  background: var(--primary-color);
}

.group-leaderboard {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 15px;
  padding: 15px;
  margin: 20px 0;
}

.leaderboard-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.leaderboard-title {
  font-size: 18px;
  color: var(--primary-color);
}

.leaderboard-period {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.6);
}

.leaderboard-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.leaderboard-item {
  display: flex;
  align-items: center;
  padding: 10px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  transition: transform 0.2s ease;
}

.leaderboard-item:hover {
  transform: scale(1.02);
}

.leaderboard-rank {
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  font-weight: bold;
  margin-right: 10px;
}

.rank-1 {
  background: linear-gradient(45deg, #FFD700, #FFA500);
  color: #000;
}

.rank-2 {
  background: linear-gradient(45deg, #C0C0C0, #A0A0A0);
  color: #000;
}

.rank-3 {
  background: linear-gradient(45deg, #CD7F32, #8B4513);
  color: #fff;
}

.leaderboard-user {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 10px;
}

.leaderboard-avatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
}

.leaderboard-points {
  font-size: 14px;
  color: var(--primary-color);
}

.pet-interaction-page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  z-index: 1001;
  overflow-y: auto;
  animation: slideIn 0.5s ease-out forwards;
  padding: calc(10px + var(--safe-area-inset-top)) 15px calc(20px + var(--safe-area-inset-bottom));
}

.interaction-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 20px 0;
}

.interaction-header h2 {
  color: white;
  margin: 0;
}

.camera-btn {
  background: none;
  border: none;
  color: white;
  font-size: 24px;
  padding: 10px;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.pet-display-area {
  text-align: center;
  margin: 20px 0;
}

.pet-avatar.large {
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.status-indicators {
  margin-top: 20px;
}

.status-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 10px 0;
}

.status-icon {
  font-size: 20px;
}

.bar-container {
  flex: 1;
  height: 10px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 5px;
  overflow: hidden;
}

.bar-fill {
  height: 100%;
  background: var(--primary-color);
  transition: width 0.3s ease;
}

.interaction-buttons-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin: 20px 0;
}

.interaction-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.1);
  border: none;
  border-radius: 15px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
}

.btn-icon {
  font-size: 24px;
}

.progress-bar {
  width: 100%;
  height: 4px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 2px;
  margin-top: 5px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--primary-color);
  width: 0%;
  transition: width 0.3s ease;
}

.tasks-rewards-section {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 15px;
  padding: 15px;
  margin: 20px 0;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.task-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.task-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
}

.task-info {
  flex: 1;
}

.task-progress-bar {
  width: 100%;
  height: 4px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 2px;
  margin: 5px 0;
  overflow: hidden;
}

.camera-mode-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  z-index: 1002;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.camera-frame {
  width: 80%;
  aspect-ratio: 1;
  border: 2px solid white;
  border-radius: 20px;
  margin-bottom: 20px;
}

.camera-controls {
  display: flex;
  gap: 20px;
}

.camera-action-btn {
  padding: 10px 20px;
  border: none;
  border-radius: 20px;
  background: var(--primary-color);
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
}

.camera-action-btn:hover {
  background: var(--secondary-color);
}

/* New styles for the growth page */
.growth-page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  z-index: 1001;
  overflow-y: auto;
  animation: slideIn 0.5s ease-out forwards;
  padding: calc(10px + var(--safe-area-inset-top)) 15px calc(20px + var(--safe-area-inset-bottom));
}

.growth-header {
  display: flex;
  align-items: center;
  padding: 20px;
  position: relative;
}

.growth-content {
  padding: 20px;
}

.level-section {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
}

.level-display {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-top: 10px;
}

.level-number {
  font-size: 36px;
  font-weight: bold;
  color: var(--primary-color);
}

.level-progress {
  flex: 1;
}

.skills-section {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
}

.skills-grid {
  display: grid;
  gap: 15px;
  margin-top: 15px;
}

.skill-item {
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
}

.skill-item.locked {
  opacity: 0.7;
}

.skill-icon {
  font-size: 24px;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
}

.skill-info {
  flex: 1;
}

.skill-info h4 {
  margin: 0;
  margin-bottom: 5px;
}

.skill-info p {
  margin: 0;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
}

.achievements-section {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 20px;
}

.achievements-list {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-top: 15px;
}

.achievement-item {
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
}

.achievement-icon {
  font-size: 24px;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
}

.achievement-info {
  flex: 1;
}

.achievement-info h4 {
  margin: 0;
  margin-bottom: 5px;
}

.achievement-info p {
  margin: 0;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
}

.completion-status {
  font-size: 12px;
}

.achievement-item.completed .completion-status {
  color: var(--primary-color);
}

.achievement-item.in-progress .completion-status {
  color: rgba(255, 255, 255, 0.7);
}

.task-page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  z-index: 1001;
  overflow-y: auto;
  animation: slideIn 0.5s ease-out forwards;
  padding: calc(10px + var(--safe-area-inset-top)) 15px calc(20px + var(--safe-area-inset-bottom));
}

.task-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 20px 0;
}

.task-header h2 {
  color: var(--primary-color);
  margin: 0;
}

.progress-overview {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 15px;
  margin: 10px 0;
}

.task-category-tabs {
  display: flex;
  gap: 10px;
  margin: 20px 0;
  overflow-x: auto;
  padding-bottom: 5px;
}

.tab-btn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  padding: 8px 16px;
  border-radius: 20px;
  color: white;
  cursor: pointer;
  white-space: nowrap;
}

.tab-btn.active {
  background: var(--primary-color);
}

.task-recommendation {
  background: rgba(138, 43, 226, 0.2);
  border-radius: 15px;
  padding: 15px;
  margin: 15px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.task-card {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 15px;
  margin: 10px 0;
  animation: fadeIn 0.3s ease-out;
}

.task-card.completed {
  opacity: 0.7;
}

.completed-tasks {
  margin: 20px 0;
}

.completed-task-card {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  margin: 5px 0;
}

.rewards-summary {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 15px;
  margin: 20px 0;
  position: fixed; 
  bottom: calc(65px + var(--safe-area-inset-bottom));
  left: 50%;
  transform: translateX(-50%);
  width: calc(100% - 30px); /* Account for padding */
  max-width: 400px; /* Match mobile container max-width */
  z-index: 100;
}

.rewards-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

.rewards-content.expanded {
  max-height: 200px;
}

.rewards-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 0;
  cursor: pointer;
}

.task-content {
  padding: 0 15px;
  margin-bottom: 80px;
}

.shop-content {
  padding: 0 15px;
  padding-bottom: calc(65px + var(--safe-area-inset-bottom));
}

.shop-header {
  position: relative;
  padding: 20px 0;
}

.currency-display {
  display: flex;
  gap: 15px;
  margin-top: 15px;
}

.currency-item {
  display: flex;
  align-items: center;
  gap: 10px;
  background: rgba(255, 255, 255, 0.1);
  padding: 8px 12px;
  border-radius: 20px;
}

.currency-amount {
  font-weight: bold;
}

.recharge-btn {
  background: var(--primary-color);
  border: none;
  padding: 4px 8px;
  border-radius: 10px;
  color: white;
  font-size: 12px;
  cursor: pointer;
}

.shop-categories {
  display: flex;
  gap: 10px;
  margin: 20px 0;
  overflow-x: auto;
  padding-bottom: 5px;
}

.category-btn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  padding: 8px 16px;
  border-radius: 20px;
  color: white;
  cursor: pointer;
  white-space: nowrap;
}

.category-btn.active {
  background: var(--primary-color);
}

.offer-grid, .vip-grid, .items-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin: 15px 0;
}

.offer-card, .vip-card, .item-card {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 15px;
  text-align: center;
  position: relative;
}

.countdown {
  position: absolute;
  top: 10px;
  right: 10px;
  background: var(--primary-color);
  padding: 4px 8px;
  border-radius: 10px;
  font-size: 12px;
}

.vip-tag {
  position: absolute;
  top: 10px;
  left: 10px;
  background: gold;
  color: black;
  padding: 4px 8px;
  border-radius: 10px;
  font-size: 12px;
}

.item-image {
  font-size: 40px;
  margin: 10px 0;
}

.price {
  margin: 10px 0;
}

.original {
  text-decoration: line-through;
  color: rgba(255, 255, 255, 0.5);
  margin-right: 5px;
}

.discounted {
  color: #ff4757;
}

.buy-btn {
  background: var(--primary-color);
  border: none;
  padding: 8px 16px;
  border-radius: 15px;
  color: white;
  cursor: pointer;
  width: 100%;
  margin-top: 10px;
}

.reward-card {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 15px;
  margin: 15px 0;
}

.reward-info {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.watch-progress {
  margin: 10px 0;
}

.progress-bar {
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
  overflow: hidden;
  margin-top: 5px;
}

.progress {
  height: 100%;
  background: var(--primary-color);
  transition: width 0.3s ease;
}

.watch-ad-btn {
  background: var(--primary-color);
  border: none;
  padding: 8px 16px;
  border-radius: 15px;
  color: white;
  cursor: pointer;
  width: 100%;
  margin-top: 10px;
}

.item-contents {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
  margin: 5px 0;
}

.vip-bonus {
  font-size: 12px;
  color: gold;
  margin: 5px 0;
}

.stock-info {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
  margin: 5px 0;
}

.quantity-selector {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin: 10px 0;
}

.quantity-selector input {
  width: 40px;
  text-align: center;
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: white;
  padding: 5px;
  border-radius: 5px;
}

.quantity-btn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: white;
  width: 24px;
  height: 24px;
  border-radius: 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.quantity-btn:hover {
  background: rgba(255, 255, 255, 0.2);
}

.shop-categories {
  display: flex;
  gap: 10px;
  margin: 20px 0;
  overflow-x: auto;
  padding-bottom: 10px;
  -webkit-overflow-scrolling: touch;
}

.category-btn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  padding: 8px 16px;
  border-radius: 20px;
  color: white;
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.3s ease;
}

.category-btn.active {
  background: var(--primary-color);
}

.offer-card, .vip-card, .item-card {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 15px;
  text-align: center;
  position: relative;
  transition: all 0.3s ease;
}

.offer-card:hover, .vip-card:hover, .item-card:hover {
  transform: translateY(-2px);
  background: rgba(255, 255, 255, 0.15);
}
</style>
</head>
<body>
  <div id="notification-container"></div>

  <div class="mobile-container">
    <header class="header">
      <div class="header-content">
        <div class="user-info">
          <div class="user-avatar">👤</div>
          <span class="user-name">用户名</span>
        </div>
        <div class="resources-mini">
          <div class="resource-mini-item">
            <span class="resource-mini-icon">🪙</span>
            <span class="resource-mini-amount">1,234</span>
          </div>
          <div class="resource-mini-item">
            <span class="resource-mini-icon">💎</span>
            <span class="resource-mini-amount">56</span>
          </div>
          <div class="resource-mini-item">
            <span class="resource-mini-icon">🎋</span>
            <span class="resource-mini-amount">89</span>
          </div>
        </div>
      </div>
    </header>

    <div class="quick-access-grid">
      <div class="quick-access-icon">
        <span>🎁</span>
        <small>礼物</small>
      </div>
      <div class="quick-access-icon" onclick="showGroupPage()">
        <span>👥</span>
        <small>群组</small>
      </div>
      <div class="quick-access-icon" onclick="showTeamPage()">
        <span>👥</span>
        <small>团队</small>
      </div>
      <div class="quick-access-icon">
        <span>📊</span>
        <small>统计</small>
      </div>
      <div class="quick-access-icon">
        <span>⚙️</span>
        <small>设置</small>
      </div>
      <div class="quick-access-icon">
        <span>❓</span>
        <small>帮助</small>
      </div>
    </div>

    <div class="panda-display">
      <div class="panda-container">
        <div class="panda-avatar">
          <span class="panda-emoji">🐼</span>
          <div class="mood-indicator">
            <span class="mood-emoji">😊</span>
          </div>
        </div>
        <div class="status-summary">
          <h3>欢迎回来!</h3>
          <p class="status-text">今日活力: 100%</p>
        </div>
        <div class="interaction-buttons">
          <button class="interact-btn">
            <span class="icon">🤚</span>
            <span>抚摸</span>
          </button>
          <button class="interact-btn">
            <span class="icon">🎋</span>
            <span>喂食</span>
          </button>
          <button class="interact-btn" onclick="navigateToPage('pet-advance')">
            <span class="icon">⭐</span>
            <span>进阶</span>
          </button>
          <button class="interact-btn" onclick="navigateToPage('garden')">
            <span class="icon">🌸</span>
            <span>后花园</span>
          </button>
          <button class="interact-btn" onclick="showPetInteractionPage()">
            <span class="icon">🌿</span>
            <span>宠物互动</span>
          </button>
        </div>
      </div>
    </div>

    <div class="pet-progress-section">
      <div class="progress-bar-container">
        <div class="progress-bar" style="width: 45%;"></div>
      </div>
      <div class="progress-labels">
        <span>婴儿期</span>
        <span>成长期</span>
        <span>成年期</span>
      </div>
      <div class="pet-stats">
        <div class="pet-stat-item">
          <div>等级: 5</div>
        </div>
        <div class="pet-stat-item">
          <div>亲密度: 789</div>
        </div>
        <div class="pet-stat-item">
          <div>心情: 愉快</div>
        </div>
        <div class="pet-stat-item">
          <div>饥饿度: 80%</div>
        </div>
      </div>
    </div>

    <button class="floating-task-btn" onclick="navigateToTaskPage()">
      <span class="icon">✨</span>
      <span>每日任务</span>
    </button>

    <div class="backpack-section">
      <h3>
        背包
        <div class="backpack-filters">
          <span class="active">全部</span>
          <span>道具</span>
          <span>奖励</span>
        </div>
      </h3>
      <div class="backpack-grid">
        <!-- Items will be dynamically inserted here -->
      </div>
    </div>

    <!-- Pet Advance Page Overlay -->
    <div class="pet-advance-page">
      <header class="advance-header">
        <button class="back-btn" onclick="hidePetAdvancePage()">←</button>
        <h2>熊猫小白升级</h2>
      </header>

      <div class="advance-content">
        <div class="pet-portrait">
          <div class="panda-avatar large">
            <span class="panda-emoji">🐼</span>
          </div>
          <div class="level-info">
            <div class="current-level">当前等级：5</div>
            <div class="target-level">目标等级：6</div>
            <div class="exp-progress">
              <div class="exp-bar">
                <div class="exp-fill" style="width: 80%;"></div>
              </div>
              <span class="exp-text">80%</span>
            </div>
          </div>
        </div>

        <div class="elements-container">
          <div class="element-slot water" data-element="water">
            <div class="element-icon">💧</div>
            <div class="element-info">
              <span>水元素</span>
              <div class="element-progress">2/4</div>
            </div>
          </div>

          <div class="element-slot wood" data-element="wood">
            <div class="element-icon">🎋</div>
            <div class="element-info">
              <span>木元素</span>
              <div class="element-progress">3/5</div>
            </div>
          </div>

          <div class="element-slot earth" data-element="earth">
            <div class="element-icon">🌱</div>
            <div class="element-info">
              <span>土元素</span>
              <div class="element-progress">8/10</div>
            </div>
          </div>

          <div class="element-slot fire" data-element="fire">
            <div class="element-icon">🔥</div>
            <div class="element-info">
              <span>火元素</span>
              <div class="element-progress">5/8</div>
            </div>
          </div>

          <div class="element-slot metal" data-element="metal">
            <div class="element-icon">⚪</div>
            <div class="element-info">
              <span>金元素</span>
              <div class="element-progress">4/6</div>
            </div>
          </div>
        </div>

        <button class="advance-btn">升级</button>

        <div class="skill-hint">
          升级后熊猫小白将获得新技能：竹林漫步
        </div>
      </div>
    </div>

    <!-- Team Page -->
    <div class="team-page" style="display: none;">
      <header class="team-header">
        <button class="back-btn" onclick="hideTeamPage()">←</button>
        <h2>Dream Team</h2>
      </header>

      <div class="team-content">
        <div class="team-info">
          <div class="team-rank">
            <span>全球排名：5</span>
          </div>
          <div class="team-progress">
            <div class="progress-bar-container">
              <div class="progress-bar" style="width: 75%"></div>
            </div>
            <span class="progress-text">75/100 任务完成</span>
          </div>
        </div>

        <div class="team-members">
          <h3>组内成员</h3>
          <div class="member-grid">
            <div class="member-card">
              <div class="member-avatar">👤</div>
              <div class="member-info">
                <div class="member-name">玩家1</div>
                <div class="member-progress">50/100 任务</div>
              </div>
              <div class="member-rank">#1</div>
            </div>
            <div class="member-card">
              <div class="member-avatar">👤</div>
              <div class="member-info">
                <div class="member-name">玩家2</div>
                <div class="member-progress">45/100 任务</div>
              </div>
              <div class="member-rank">#2</div>
            </div>
            <div class="member-card">
              <div class="member-avatar">👤</div>
              <div class="member-info">
                <div class="member-name">玩家3</div>
                <div class="member-progress">40/100 任务</div>
              </div>
              <div class="member-rank">#3</div>
            </div>
          </div>
        </div>

        <div class="team-milestones">
          <h3>团队里程碑</h3>
          <div class="milestone-list">
            <div class="milestone-item achieved">
              <div class="milestone-icon">🏆</div>
              <div class="milestone-info">
                <div class="milestone-title">初级里程碑</div>
                <div class="milestone-desc">完成50个团队任务</div>
              </div>
              <div class="milestone-reward">+10% 资源加成</div>
            </div>
            <div class="milestone-item">
              <div class="milestone-icon">🌟</div>
              <div class="milestone-info">
                <div class="milestone-title">中级里程碑</div>
                <div class="milestone-desc">完成100个团队任务</div>
              </div>
              <div class="milestone-reward">+20% 资源加成</div>
            </div>
            <div class="milestone-item">
              <div class="milestone-icon">👑</div>
              <div class="milestone-info">
                <div class="milestone-title">高级里程碑</div>
                <div class="milestone-desc">完成200个团队任务</div>
              </div>
              <div class="milestone-reward">+30% 资源加成</div>
            </div>
          </div>
        </div>

        <div class="team-actions">
          <button class="interact-btn">
            <span class="icon">📢</span>
            <span>团队公告</span>
          </button>
          <button class="interact-btn">
            <span class="icon">🤝</span>
            <span>邀请好友</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Group Page -->
    <div class="group-page" style="display: none;">
      <header class="group-header">
        <button class="back-btn" onclick="hideGroupPage()">←</button>
        <h2>群组</h2>
      </header>

      <div class="group-content">
        <!-- Milestone Notice -->
        <div class="milestone-notice">
          <div class="notice-card">
            <span class="notice-icon">🎯</span>
            <div class="notice-content">
              <h4>里程碑收益</h4>
              <p>群组成员率先达成里程碑时，全体成员可享受额外加成：</p>
              <ul>
                <li>日常任务收益 +10%</li>
                <li>成长速度 +5%</li>
                <li>互动奖励 +15%</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Regional Leaderboard -->
        <div class="group-leaderboard">
          <div class="leaderboard-header">
            <h3 class="leaderboard-title">地区榜</h3>
            <div class="region-filters">
              <select class="region-select" onchange="updateRegionFilter(this.value)">
                <option value="country">全国</option>
                <option value="province">省份</option>
                <option value="city">城市</option>
              </select>
            </div>
            <div class="leaderboard-filters">
              <span class="filter-option active" data-period="day">日</span>
              <span class="filter-option" data-period="week">周</span>
              <span class="filter-option" data-period="month">月</span>
              <span class="filter-option" data-period="year">年</span>
            </div>
          </div>
          <div class="leaderboard-list regional">
            <!-- Regional leaderboard items will be inserted here -->
          </div>
        </div>

        <!-- Interest-based Leaderboard -->
        <div class="group-leaderboard">
          <div class="leaderboard-header">
            <h3 class="leaderboard-title">兴趣榜</h3>
            <div class="leaderboard-filters">
              <span class="filter-option active" data-period="day">日</span>
              <span class="filter-option" data-period="week">周</span>
              <span class="filter-option" data-period="month">月</span>
              <span class="filter-option" data-period="year">年</span>
            </div>
          </div>
          <div class="leaderboard-list interest">
            <!-- Interest-based leaderboard items will be inserted here -->
          </div>
        </div>

        <!-- Group Cards Container -->
        <div class="group-cards">
          <!-- Group cards will be inserted here -->
        </div>
      </div>
    </div>

    <nav class="bottom-nav">
      <button class="nav-item active" data-page="home" onclick="navigateToPage('home')">
        <span class="nav-icon">🏠</span>
        <span>主页</span>
      </button>
      <button class="nav-item" data-page="challenge" onclick="navigateToPage('challenge')">
        <span class="nav-icon">🎯</span>
        <span>挑战</span>
      </button>
      <button class="nav-item" data-page="task" onclick="navigateToTaskPage()">
        <span class="nav-icon">✨</span>
        <span>任务</span>
      </button>
      <button class="nav-item" data-page="journey" onclick="navigateToPage('journey')">
        <span class="nav-icon">🗺️</span>
        <span>成长</span>
      </button>
      <button class="nav-item" data-page="shop" onclick="navigateToPage('shop')">
        <span class="nav-icon">🎁</span>
        <span>商店</span>
      </button>
    </nav>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    initializeHomePage();

    const navItems = document.querySelectorAll('.nav-item');
    navItems.forEach(item => {
      item.classList.toggle('active', item.dataset.page === 'home');
    });

    const backBtn = document.querySelector('.pet-advance-page .back-btn');
    if (backBtn) {
      backBtn.addEventListener('click', hidePetAdvancePage);
    }
    
    const elementSlots = document.querySelectorAll('.element-slot');
    elementSlots.forEach(slot => {
      slot.addEventListener('click', () => {
        const element = slot.dataset.element;
        showElementDetails(element);
      });
    });

    // Initialize group page related elements
    const groupPage = document.querySelector('.group-page');
    if (groupPage) {
      const filterOptions = groupPage.querySelectorAll('.filter-option');
      filterOptions.forEach(option => {
        option.addEventListener('click', function() {
          const period = this.dataset.period;
          const filterGroup = this.closest('.leaderboard-filters');
          filterGroup.querySelectorAll('.filter-option').forEach(opt => {
            opt.classList.remove('active');
          });
          this.classList.add('active');
          updateLeaderboard(period);
        });
      });
    }
  });

  function initializeHomePage() {
    // Initialize backpack grid items
    initializeBackpack();
    
    // Initialize other home page elements
    updatePetStatus();
    updateResources();
  }

  function initializeBackpack() {
    const backpackGrid = document.querySelector('.backpack-grid');
    if (!backpackGrid) return;
    
    // Clear existing items
    backpackGrid.innerHTML = '';
    
    // Add some sample items
    const items = [
      { icon: '🎋', count: 5, isNew: true },
      { icon: '🍎', count: 3 },
      { icon: '🦴', count: 2 },
      { icon: '🎁', count: 1, isNew: true },
      // Add empty slots
      ...Array(4).fill({ empty: true })
    ];
    
    items.forEach(item => {
      const itemDiv = document.createElement('div');
      itemDiv.className = `backpack-item${item.empty ? ' empty' : ''}`;
      
      if (!item.empty) {
        itemDiv.innerHTML = `
          <span class="backpack-item-icon">${item.icon}</span>
          <span class="backpack-item-count">x${item.count}</span>
          ${item.isNew ? '<span class="backpack-item-new">NEW</span>' : ''}
        `;
        itemDiv.addEventListener('click', () => showItemDetails(item));
      }
      
      backpackGrid.appendChild(itemDiv);
    });
  }

  function updatePetStatus() {
    // Update pet status indicators
    const moodEmoji = document.querySelector('.mood-emoji');
    if (moodEmoji) {
      moodEmoji.textContent = '😊'; // Default happy mood
    }
    
    // Update progress bars
    const progressBars = document.querySelectorAll('.progress-bar');
    progressBars.forEach(bar => {
      if (!bar.style.width) {
        bar.style.width = '45%'; // Default progress
      }
    });
  }

  function updateResources() {
    // Update resource amounts in the header
    const resourceAmounts = document.querySelectorAll('.resource-mini-amount');
    const defaultValues = ['1,234', '56', '89'];
    
    resourceAmounts.forEach((amount, index) => {
      if (amount.textContent === '') {
        amount.textContent = defaultValues[index];
      }
    });
  }

  function showItemDetails(item) {
    // Implement item details modal display logic
    console.log('Showing details for item:', item);
  }

  function hidePetAdvancePage() {
    const advancePage = document.querySelector('.pet-advance-page');
    if (advancePage) {
      advancePage.style.display = 'none';
    }
  }

  function hideGroupPage() {
    const groupPage = document.querySelector('.group-page');
    if (groupPage) {
      groupPage.style.display = 'none';
    }
  }

  function hideTeamPage() {
    const teamPage = document.querySelector('.team-page');
    if (teamPage) {
      teamPage.style.display = 'none';
    }
  }

  function updateLeaderboard(period) {
    // Implement leaderboard update logic
    console.log('Updating leaderboard for period:', period);
  }

  function updateRegionFilter(region) {
    // Implement region filter logic
    console.log('Updating region filter:', region);
  }

  function showElementDetails(element) {
    // Implement element details display logic
    console.log('Showing details for element:', element);
  }

  function navigateToPage(page) {
    // Reset all nav items active state
    document.querySelectorAll('.nav-item').forEach(item => {
      item.classList.toggle('active', item.dataset.page === page);
    });

    // Hide all pages first
    const pages = ['pet-advance-page', 'team-page', 'group-page'];
    pages.forEach(pageName => {
      const pageElement = document.querySelector(`.${pageName}`);
      if (pageElement) {
        pageElement.style.display = 'none';
      }
    });

    // Handle specific page navigation
    switch (page) {
      case 'home':
        // Show home content
        initializeHomePage();
        break;
        
      case 'pet-advance':
        const advancePage = document.querySelector('.pet-advance-page');
        if (advancePage) {
          advancePage.style.display = 'block';
        }
        break;

      case 'task':
        navigateToTaskPage();
        break;

      case 'journey':
        navigateToGrowthPage();
        break;

      case 'garden':
        // Implement garden page navigation
        break;

      case 'challenge':
        // Implement challenge page navigation
        break;

      case 'shop':
        const mobileContainer = document.querySelector('.mobile-container');
        const previousContent = mobileContainer.innerHTML;
        const header = document.querySelector('.header').cloneNode(true);
        const bottomNav = document.querySelector('.bottom-nav').cloneNode(true);
        
        mobileContainer.innerHTML = '';
        mobileContainer.appendChild(header);

        const backBtn = document.createElement('button');
        backBtn.className = 'back-btn';
        backBtn.innerHTML = '←';
        backBtn.onclick = () => {
          mobileContainer.innerHTML = previousContent;
          const navItems = document.querySelectorAll('.nav-item');
          navItems.forEach(item => {
            item.classList.toggle('active', item.dataset.page === 'home');
          });
        };

        const shopContent = `
          <div class="shop-content">
            <header class="shop-header">
              <h2>Shop</h2>
              <div class="currency-display">
                <div class="currency-item">
                  <span class="currency-icon">🪙</span>
                  <span class="currency-amount">1,234</span>
                  <button class="recharge-btn">充值</button>
                </div>
                <div class="currency-item">
                  <span class="currency-icon">💎</span>
                  <span class="currency-amount">56</span>
                  <button class="recharge-btn">充值</button>
                </div>
                <div class="currency-item">
                  <span class="currency-icon">🎋</span>
                  <span class="currency-amount">89</span>
                  <button class="recharge-btn">获取</button>
                </div>
              </div>
            </header>

            <div class="shop-categories">
              <button class="category-btn active" data-category="gold">金币商城</button>
              <button class="category-btn" data-category="diamond">钻石商城</button>
              <button class="category-btn" data-category="vip">VIP专区</button>
              <button class="category-btn" data-category="limited">限时商品</button>
              <button class="category-btn" data-category="gift">礼包</button>
            </div>

            <div class="limited-time-offers">
              <h3>限时优惠 <span style="color: #ff4757">🔥热销中</span></h3>
              <div class="offer-grid">
                <div class="offer-card">
                  <div class="countdown">剩余: 1小时</div>
                  <span class="discount-tag">-20%</span>
                  <div class="item-image">🎁</div>
                  <h4>超值成长礼包</h4>
                  <div class="price">
                    <span class="original">100金币</span>
                    <span class="discounted">80金币</span>
                  </div>
                  <div class="item-contents">
                    <small>包含: 竹子x10, 体力药水x5, 随机装饰x1</small>
                  </div>
                  <div class="purchase-limit">今日限购1次</div>
                  <button class="buy-btn">购买</button>
                </div>
                <div class="offer-card">
                  <div class="countdown">剩余: 2小时</div>
                  <span class="discount-tag">-25%</span>
                  <div class="item-image">💝</div>
                  <h4>每日特惠礼包</h4>
                  <div class="price">
                    <span class="original">200钻石</span>
                    <span class="discounted">150钻石</span>
                  </div>
                  <div class="item-contents">
                    <small>包含: 高级道具x3, 随机装饰x2, 限定称号x1</small>
                  </div>
                  <div class="purchase-limit">每周限购3次</div>
                  <button class="buy-btn">购买</button>
                </div>
              </div>
            </div>

            <div class="daily-specials">
              <h3>每日特惠</h3>
              <div class="items-grid">
                <div class="item-card">
                  <span class="refresh-timer">23:45:12后刷新</span>
                  <div class="item-image">🎋</div>
                  <h4>豪华竹子礼盒</h4>
                  <div class="item-desc">高品质竹子礼盒，内含稀有竹子</div>
                  <div class="price">
                    <span class="original">500金币</span>
                    <span class="discounted">400金币</span>
                  </div>
                  <div class="stock-info">今日剩余: 5个</div>
                  <button class="buy-btn">限时抢购</button>
                </div>
                <div class="item-card">
                  <span class="refresh-timer">23:45:12后刷新</span>
                  <div class="item-image">🌟</div>
                  <h4>幸运星礼盒</h4>
                  <div class="item-desc">开启可随机获得珍稀道具</div>
                  <div class="price">
                    <span class="original">1000金币</span>
                    <span class="discounted">800金币</span>
                  </div>
                  <div class="stock-info">今日剩余: 3个</div>
                  <button class="buy-btn">限时抢购</button>
                </div>
              </div>
            </div>

            <div class="vip-section">
              <h3>VIP专区 <span style="color: gold">👑尊享特权</span></h3>
              <div class="vip-grid">
                <div class="vip-card">
                  <div class="vip-tag">VIP专属</div>
                  <div class="item-image">👑</div>
                  <h4>皇冠装饰套装</h4>
                  <div class="price">500钻石</div>
                  <div class="vip-bonus">
                    <small>VIP额外获得: 专属头像框、聊天气泡</small>
                  </div>
                  <div class="vip-discount">VIP价: 400钻石</div>
                  <button class="buy-btn">购买</button>
                </div>
                <div class="vip-card">
                  <div class="vip-tag">VIP专属</div>
                  <div class="item-image">🌟</div>
                  <h4>闪耀特效礼包</h4>
                  <div class="price">300钻石</div>
                  <div class="vip-bonus">
                    <small>VIP额外获得: 专属徽章、粒子特效</small>
                  </div>
                  <div class="vip-discount">VIP价: 240钻石</div>
                  <button class="buy-btn">购买</button>
                </div>
              </div>
            </div>

            <div class="regular-items">
              <h3>日常商品</h3>
              <div class="items-grid">
                <div class="item-card">
                  <div class="item-image">🎋</div>
                  <h4>新鲜竹子</h4>
                  <div class="item-desc">恢复宠物10点健康值</div>
                  <div class="item-effects">
                    <span>效果: 健康值+10</span>
                    <span>持续时间: 即时</span>
                  </div>
                  <div class="stock-info">库存: 999+</div>
                  <div class="price">20金币/个</div>
                  <div class="quantity-selector">
                    <button class="quantity-btn">-</button>
                    <input type="number" value="1" min="1" max="99">
                    <button class="quantity-btn">+</button>
                  </div>
                  <button class="buy-btn">购买</button>
                </div>
                <div class="item-card">
                  <div class="item-image">🍯</div>
                  <h4>能量蜂蜜</h4>
                  <div class="item-desc">快速恢复宠物体力</div>
                  <div class="item-effects">
                    <span>效果: 体力+20</span>
                    <span>持续时间: 即时</span>
                  </div>
                  <div class="stock-info">库存: 50</div>
                  <div class="price">30金币/个</div>
                  <div class="quantity-selector">
                    <button class="quantity-btn">-</button>
                    <input type="number" value="1" min="1" max="99">
                    <button class="quantity-btn">+</button>
                  </div>
                  <button class="buy-btn">购买</button>
                </div>
                <div class="item-card">
                  <div class="item-image">🎨</div>
                  <h4>进阶涂料</h4>
                  <div class="item-desc">提升宠物进阶几率</div>
                  <div class="item-effects">
                    <span>效果: 进阶概率+5%</span>
                    <span>持续时间: 24小时</span>
                  </div>
                  <div class="stock-info">库存: 25</div>
                  <div class="price">50钻石/个</div>
                  <div class="quantity-selector">
                    <button class="quantity-btn">-</button>
                    <input type="number" value="1" min="1" max="99">
                    <button class="quantity-btn">+</button>
                  </div>
                  <button class="buy-btn">购买</button>
                </div>
              </div>
            </div>

            <div class="ad-rewards">
              <h3>福利中心</h3>
              <div class="reward-card">
                <div class="reward-info">
                  <span class="reward-icon">🎁</span>
                  <span>每日观看广告领金币</span>
                  <span class="bonus-tag">今日双倍</span>
                </div>
                <div class="watch-progress">
                  <div class="progress-text">今日剩余: 5/10次</div>
                  <div class="progress-bar">
                    <div class="progress" style="width: 50%"></div>
                  </div>
                </div>
                <div class="reward-amount">可获得: 40金币</div>
                <button class="watch-ad-btn">观看广告</button>
              </div>
              <div class="reward-card">
                <div class="reward-info">
                  <span class="reward-icon">💎</span>
                  <span>看广告领钻石</span>
                  <span class="bonus-tag">VIP额外+1</span>
                </div>
                <div class="watch-progress">
                  <div class="progress-text">今日剩余: 3/5次</div>
                  <div class="progress-bar">
                    <div class="progress" style="width: 40%"></div>
                  </div>
                </div>
                <div class="reward-amount">可获得: 2钻石</div>
                <button class="watch-ad-btn">观看广告</button>
              </div>
            </div>
          </div>
        `;

        const shopContainer = document.createElement('div');
        shopContainer.innerHTML = shopContent;
        
        // Insert back button into the header
        const shopHeader = shopContainer.querySelector('.shop-header');
        shopHeader.insertBefore(backBtn, shopHeader.firstChild);
        
        mobileContainer.appendChild(shopContainer);
        mobileContainer.appendChild(bottomNav);

        // Update nav items
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
          item.classList.toggle('active', item.dataset.page === 'shop');
        });
        break;
    }
  }

  function navigateToTaskPage() {
    const mobileContainer = document.querySelector('.mobile-container');
    
    // Store previous content directly without URI encoding/decoding
    const previousContent = mobileContainer.innerHTML;
    
    // Keep the header
    const header = document.querySelector('.header').cloneNode(true);
    const bottomNav = document.querySelector('.bottom-nav').cloneNode(true);
    
    mobileContainer.innerHTML = '';
    mobileContainer.appendChild(header);

    const backBtn = document.createElement('button');
    backBtn.className = 'back-btn';
    backBtn.innerHTML = '←';
    backBtn.onclick = () => backFromTaskPage(previousContent);
    
    const taskContent = `
      <div class="task-content">
        <header class="task-header">
          <h2>每日任务</h2>
        </header>

        <div class="progress-overview">
          <div class="progress-bar-container">
            <div class="progress-bar" style="width: 60%;"></div>
          </div>
          <div class="progress-labels">
            <span>今日完成: 6/10</span>
          </div>
        </div>

        <div class="task-category-tabs">
          <button class="tab-btn active">全部</button>
          <button class="tab-btn">日常</button>
          <button class="tab-btn">周常</button>
          <button class="tab-btn">成就</button>
        </div>

        <div class="task-recommendation">
          <div>
            <h4>推荐任务</h4>
            <p>完成3个运动任务</p>
          </div>
          <button class="interact-btn">开始</button>
        </div>

        <div class="task-list">
          <div class="task-card">
            <h4>晨跑30分钟</h4>
            <div class="progress-bar-container">
              <div class="progress-bar" style="width: 0%;"></div>
            </div>
            <div class="task-actions">
              <button class="interact-btn">开始</button>
            </div>
          </div>

          <div class="task-card completed">
            <h4>喝水打卡</h4>
            <div class="progress-bar-container">
              <div class="progress-bar" style="width: 100%;"></div>
            </div>
            <div class="task-actions">
              <button class="interact-btn" disabled>已完成</button>
            </div>
          </div>
        </div>

        <div class="completed-tasks">
          <h3>已完成任务</h3>
          <div class="completed-task-card">
            <span class="task-icon">✅</span>
            <div class="task-info">
              <h4>每日打卡</h4>
              <p>获得: 100金币</p>
            </div>
          </div>
        </div>

        <!-- Add margin to bottom to account for fixed rewards summary -->
        <div style="height: 120px;"></div>
      </div>
      
      <div class="rewards-summary">
        <div class="rewards-header" onclick="toggleRewardsContent()">
          <h4>今日奖励</h4>
          <span>点击展开</span>
        </div>
        <div class="rewards-content">
          <p>金币: +500</p>
          <p>经验: +200</p>
        </div>
      </div>`;

    const taskContainer = document.createElement('div');
    taskContainer.innerHTML = taskContent;
    
    // Insert back button into the header
    const taskHeader = taskContainer.querySelector('.task-header');
    taskHeader.insertBefore(backBtn, taskHeader.firstChild);
    
    mobileContainer.appendChild(taskContainer);
    mobileContainer.appendChild(bottomNav);

    // Update nav items
    const navItems = document.querySelectorAll('.nav-item');
    navItems.forEach(item => {
      item.classList.toggle('active', item.dataset.page === 'task');
    });
  }

  function backFromTaskPage(previousContent) {
    if (previousContent) {
      const mobileContainer = document.querySelector('.mobile-container');
      mobileContainer.innerHTML = previousContent; // Remove decodeURIComponent
      
      // Update nav items
      const navItems = document.querySelectorAll('.nav-item');
      navItems.forEach(item => {
        item.classList.toggle('active', item.dataset.page === 'home');
      });
    }
  }

  function toggleRewardsContent() {
    const rewardsContent = document.querySelector('.rewards-content');
    rewardsContent.classList.toggle('expanded');
  }

  </script>

</body>
</html>